<!DOCTYPE html>
<html lang="zh-Hant">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">
<title>WBC Pitch Count</title>

<style>
html, body {
  margin: 0;
  padding: 0;
  height: 100%;
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
  background: #f2f2f7;
}

h3 {
  margin: 6px 0;
  text-align: center;
  font-size: 16px;
}

table {
  width: 100%;
  height: calc(100vh - 36px);
  border-collapse: collapse;
  table-layout: fixed;
  background: white;
}

th, td {
  border: 1px solid #ddd;
  text-align: center;
  padding: 0;
  font-size: 13px;
}

thead th {
  background: #1e4252;
  color: white;
  font-weight: 600;
}

th:first-child, td:first-child {
  width: 28%;
  text-align: left;
  padding-left: 6px;
  font-weight: 500;
}

tbody tr:nth-child(odd) {
  background: #fafafa;
}

tbody tr:nth-child(even) {
  background: #f0f0f5;
}

input {
  width: 44px;
  height: 20px;
  border-radius: 6px;
  border: 1px solid #bbb;
  text-align: center;
  font-size: 13px;
  background: white;
  padding: 0;
  box-sizing: border-box;
}


input:focus {
  outline: none;
  border-color: #007aff;
  background: #eef5ff;
}

.blocked {
  background: #ffd6d6;
  color: #b00020;
  font-weight: 700;
}
}
</style>
</head>

<body>

<h3>WBC Pitch Count</h3>

<table id="pitchTable">
  <thead>
    <tr>
      <th>Pitcher</th>
      <th>3/5 ðŸ‡¦ðŸ‡º</th>
      <th>3/6 ðŸ‡¯ðŸ‡µ</th>
      <th>3/7 ðŸ‡¨ðŸ‡¿</th>
      <th>3/8 ðŸ‡°ðŸ‡·</th>
    </tr>
  </thead>
  <tbody></tbody>
</table>

<script>
const pitchers = [
  "å¤æž—ç¿ç…¬","å¾è‹¥ç†™","æž—æ˜±ç‰","æž—ç¶­æ©","é„­æµ©å‡","èŽŠé™³ä»²æ•–","é™³æŸæ¯“","èƒ¡æ™ºçˆ²",
  "æ²™å­å®¸","å­«æ˜“ç£Š","å¼µå¥•","å¼µå³»ç‘‹","é™³å† å®‡","æž—å‡±å¨","æž—è©©ç¿”","æ›¾å³»å²³",
];

const days = 4;
const tbody = document.querySelector("#pitchTable tbody");

pitchers.forEach((name, r) => {
  const tr = document.createElement("tr");
  tr.innerHTML = `<td>${name}</td>`;
  for (let d = 0; d < days; d++) {
    const td = document.createElement("td");
    const input = document.createElement("input");
    input.type = "text";
    input.inputMode = "numeric";
    input.pattern = "[0-9]*";
    input.dataset.row = r;
    input.dataset.day = d;
    input.addEventListener("input", recalc);
    td.appendChild(input);
    tr.appendChild(td);
  }
  tbody.appendChild(tr);
});

function recalc() {
  document.querySelectorAll("td").forEach(td => {
    td.classList.remove("blocked");
    const input = td.querySelector("input");
    if (input) input.disabled = false;
    if (td.textContent === "X") td.textContent = "";
  });

  pitchers.forEach((_, r) => {
    let lastPlayedDay = -10;

    for (let d = 0; d < days; d++) {
      const cell = getCell(r, d);
      const input = cell.querySelector("input");
      if (!input) continue;

      const val = Number(input.value);
      if (!val) continue;

      if (d - lastPlayedDay === 1 && d + 1 < days) blockCell(r, d + 1);
      if (val >= 30 && val < 50 && d + 1 < days) blockCell(r, d + 1);
      if (val >= 50) for (let k = d + 1; k < days; k++) blockCell(r, k);

      lastPlayedDay = d;
    }
  });
}

function getCell(r, d) {
  return tbody.children[r].children[d + 1];
}

function blockCell(r, d) {
  const cell = getCell(r, d);
  if (cell.querySelector("input")) {
    cell.innerHTML = "X";
    cell.classList.add("blocked");
  }
}
</script>

</body>
</html>
