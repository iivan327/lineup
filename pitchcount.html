<!DOCTYPE html>
<html lang="zh-Hant">
<head>
<meta charset="UTF-8">
<title>WBC Pitch Count</title>
<style>
  table { border-collapse: collapse; }
  th, td {
    border: 1px solid #444;
    padding: 6px;
    text-align: center;
    min-width: 70px;
  }
  th:first-child, td:first-child {
    min-width: 120px;
    text-align: left;
  }
  input {
    width: 50px;
    text-align: center;
  }
  .blocked {
    background: #eee;
    color: #999;
    font-weight: bold;
  }
</style>
</head>
<body>

<h3>æŠ•æ‰‹é€å ´ç”¨çƒæ•¸ï¼ˆWBC é™åˆ¶ï¼‰</h3>

<table id="pitchTable">
  <thead>
    <tr>
      <th>Pitcher</th>
      <th>3/5 ğŸ‡¦ğŸ‡º</th>
      <th>3/6 ğŸ‡¯ğŸ‡µ</th>
      <th>3/7 ğŸ‡¨ğŸ‡¿</th>
      <th>3/8 ğŸ‡°ğŸ‡·</th>
    </tr>
  </thead>
  <tbody></tbody>
</table>

<script>
const pitchers = [
  "å¤æ—ç¿ç…¬","å¾è‹¥ç†™","æ—æ˜±ç‰","æ—ç¶­æ©","é„­æµ©å‡","èŠé™³ä»²æ•–","é™³æŸæ¯“","èƒ¡æ™ºçˆ²",
  "æ²™å­å®¸","å­«æ˜“ç£Š","å¼µå¥•","å¼µå³»ç‘‹","é™³å† å®‡","æ—å‡±å¨","æ—è©©ç¿”","æ›¾å³»å²³",
];

const days = 4;
const tbody = document.querySelector("#pitchTable tbody");

pitchers.forEach((name, r) => {
  const tr = document.createElement("tr");
  tr.innerHTML = `<td>${name}</td>`;
  for (let d = 0; d < days; d++) {
    const td = document.createElement("td");
    const input = document.createElement("input");
    input.type = "number";
    input.min = 0;
    input.dataset.row = r;
    input.dataset.day = d;
    input.addEventListener("input", recalc);
    td.appendChild(input);
    tr.appendChild(td);
  }
  tbody.appendChild(tr);
});

function recalc() {
  // reset
  document.querySelectorAll("td").forEach(td => {
    td.classList.remove("blocked");
    const input = td.querySelector("input");
    if (input) input.disabled = false;
    if (td.textContent === "X") td.textContent = "";
  });

  pitchers.forEach((_, r) => {
    let lastPlayedDay = -10;

    for (let d = 0; d < days; d++) {
      const cell = getCell(r, d);
      const input = cell.querySelector("input");
      if (!input) continue;

      const val = Number(input.value);
      if (!val) continue;

      // é€£å…©å¤©å‡ºè³½ â†’ ä¸‹ä¸€å¤© X
      if (d - lastPlayedDay === 1 && d + 1 < days) {
        blockCell(r, d + 1);
      }

      // 30â€“49 çƒ â†’ éš”å¤© X
      if (val >= 30 && val < 50 && d + 1 < days) {
        blockCell(r, d + 1);
      }

      // 50 çƒä»¥ä¸Š â†’ å¾Œé¢å…¨ X
      if (val >= 50) {
        for (let k = d + 1; k < days; k++) {
          blockCell(r, k);
        }
      }

      lastPlayedDay = d;
    }
  });
}

function getCell(r, d) {
  return tbody.children[r].children[d + 1];
}

function blockCell(r, d) {
  const cell = getCell(r, d);
  if (cell.querySelector("input")) {
    cell.innerHTML = "X";
    cell.classList.add("blocked");
  }
}
</script>

</body>
</html>
